
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Peter Brooksbank - Improving blog page load time</title>
        <meta name="description" content="Hi, I&#x27;m Peter" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Peter Brooksbank" href="/feed.rss" />
                <link type="application/atom+xml" rel="alternate" title="Peter Brooksbank" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">        

        <meta name="google-site-verification" content="aPcU4mF-tJDyipAevmgakMIKzyPHSfDYNhPk9BQXALw" />
        <meta name="application-name" content="Peter Brooksbank" />
        <meta name="msapplication-tooltip" content="Peter Brooksbank" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Peter Brooksbank - Improving blog page load time" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://peterbrooksbank.com/posts/tweaking-wyams-clean-blog-theme" />

        <script src="/assets/js/jquery-3.4.1.slim.min.js"></script>
        <script src="/assets/js/bootstrap.min.js" defer async></script>
                        
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
                <script src="/assets/js/html5shiv.js"></script>
                <script src="/assets/js/respond.min.js"></script>
        <![endif]-->
        
        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Peter Brooksbank</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header" style="background-image: url(&quot;/assets/img/ripple-scaled-down.webp&quot;)">                      
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Improving blog page load time</h1>
    <div class="meta">        
Published on 11 July 2019<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/blogging" class="btn btn-default btn-xs">blogging</a>
                    <a role="button" href="/tags/load-time" class="btn btn-default btn-xs">load time</a>
                    <a role="button" href="/tags/performance" class="btn btn-default btn-xs">performance</a>
                    <a role="button" href="/tags/wyam" class="btn btn-default btn-xs">wyam</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p>The default Wyam blog themes are a good starting point but what can we do to improve load times when we apply a critical eye?</p>
<p>When I created the blog I chose to use the CleanBlog theme (<a href="https://wyam.io/recipes/blog/themes/preview/cleanblog/">preview</a>). This, along with a few others, are provided out of the box by Wyam. They provide an excellent starting point to hit the ground running and a clean base to begin modifying.</p>
<h2 id="where-to-start">Where to start?</h2>
<p>Most blogs have the same set of initial priorities, ranging from the overall design to getting some eyes on posts. However, we all have a different order for these priorities. For me the first aspect is page load time, I like making things fast. I get passionate about taking a hot spot in a critical path and finding ways to improve it. Often an impact can be made by simplifying the existing code, refactoring it to reduce the work done and hopefully making it clearer to read in the process.</p>
<p>A good place to start with the speed of web pages is <a href="https://developers.google.com/speed/pagespeed/insights/">PageSpeed Insights by Google</a> which analyzes the content and then generates suggestions to make that page faster. As performance is now one of the key metrics Google uses for site ranking in their search results, it's worthwhile having a look to see what gets suggested. The scores can fluctuate by a couple of points between runs but I found that several runs gave an average of 73 for the home page. The key takeaway was the time required for render-blocking resources which looked like this:</p>
<table class="table">
<thead>
<tr>
<th>URL</th>
<th>Size</th>
<th>Potential Savings</th>
</tr>
</thead>
<tbody>
<tr>
<td>…css/bootstrap.min.css(wyam.io)</td>
<td>20 KB</td>
<td>1,080 ms</td>
</tr>
<tr>
<td>…css/highlight.css(wyam.io)</td>
<td>1 KB</td>
<td>480 ms</td>
</tr>
<tr>
<td>…css/clean-blog.css(wyam.io)</td>
<td>2 KB</td>
<td>480 ms</td>
</tr>
<tr>
<td>…css/master.css(wyam.io)</td>
<td>1 KB</td>
<td>480 ms</td>
</tr>
<tr>
<td>…css/font-awesome.min.css(wyam.io)</td>
<td>7 KB</td>
<td>780 ms</td>
</tr>
<tr>
<td>/css?family=Lora:400,700,400italic,700italic(fonts.googleapis.com)</td>
<td>1 KB</td>
<td>780 ms</td>
</tr>
<tr>
<td>/css?family=…(fonts.googleapis.com)</td>
<td>2 KB</td>
<td>780 ms</td>
</tr>
<tr>
<td>…css/override.css(wyam.io)</td>
<td>0 KB</td>
<td>480 ms</td>
</tr>
<tr>
<td>…js/jquery.min.js(wyam.io)</td>
<td>30 KB</td>
<td>1,080 ms</td>
</tr>
<tr>
<td>…js/bootstrap.min.js(wyam.io)</td>
<td>10 KB</td>
<td>480 ms</td>
</tr>
<tr>
<td>…js/highlight.pack.js(wyam.io)</td>
<td>25 KB</td>
<td>930 ms</td>
</tr>
<tr>
<td>…js/clean-blog.js(wyam.io)</td>
<td>1 KB</td>
<td>180 ms</td>
</tr>
<tr>
<td>…js/d3.v3.min.js(wyam.io)</td>
<td>53 KB</td>
<td>1,230 ms</td>
</tr>
<tr>
<td>…js/trianglify.min.js(wyam.io)</td>
<td>5 KB</td>
<td>330 ms</td>
</tr>
<tr>
<td>…js/Please-compressed.js(wyam.io)</td>
<td>3 KB</td>
<td>180 ms</td>
</tr>
<tr>
<td>…js/background-check.min.js(wyam.io)</td>
<td>4 KB</td>
<td>180 ms</td>
</tr>
</tbody>
</table>
<p>That's a lot of resources for a home page with not much happening. Let's break down what's going on with all of this:</p>
<ul>
<li>Highlight is for code syntax highlighting</li>
<li>Bootstrap, clean-blog, master and override are the CSS for the blog in general</li>
<li>Font awesome for the RSS icon</li>
<li>Font files from google fonts used by the theme</li>
<li>jquery.min.js, bootstrap.min.js, highlight.pack.js, clean-blog.js for general theme functions</li>
<li>Background-check for switching text colour depending on the colour in the background on the header</li>
<li>D3, Trianglify and Please-compressed for generating the image in the header</li>
</ul>
<p>Yup, the image in the header is generated by JavaScript and it's render-blocking. This one's an easy win, we can remove the bottom 4 JavaScript files and replace them with a single webp image which isn't render blocking. Sure it's not quite as cool as generating a triangular mesh that's different per request but it's good enough for my purposes.</p>
<p>Next I took a look at the font files. We're loading both Lora and Open-Sans in a variety of weights and italics. For my simple blog I don't need all of these. For now I removed all external fonts and I'll revisit the fonts I want on my blog in the future when I look at tweaking the design of the blog itself. In a similar vein I removed the font-awesome file. It was been used for a single icon, the RSS icon. I replaced this with a piece of inline SVG to keep the benefit of using a font without the size of the entire file.</p>
<p>The final step in this process was to look at the CSS been used by the site. First up was Bootstrap, a lot of the CSS included by default wasn't been used so I used their <a href="https://getbootstrap.com/docs/3.4/customize/">online bundle builder</a> to grab a version of the CSS with only bits I wanted in it. Note that this theme uses Bootstrap 3 and not the newer Bootstrap 4. I took a look at Highlight next. As it was so small I decided to remove the network hit and simple inline it in the page itself. I then did the same with the master.css and clean-blog.css.</p>



                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © 2019 by Peter Brooksbank. The opinions expressed herein are my own and do not represent my employer's view in any way.
                        <br />
                            <a class="rss" href="/feed.rss">
                                <svg xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 24 24"><title>  RSS icon</title><path d="M19.2 24C19.2 13.5 10.5 4.8 0 4.8V0c13.2 0 24 10.8 24 24h-4.8zM3.3 17.4c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3C1.5 24 0 22.5 0 20.7s1.5-3.3 3.3-3.3zM15.9 24h-4.7c0-6.2-5.1-11.2-11.2-11.2V8.1c8.7 0 15.9 7.2 15.9 15.9z"/></svg> RSS Feed</a>
                        |
                            <a class="rss" href="/feed.atom">
                                <svg xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 24 24"><title>  RSS icon</title><path d="M19.2 24C19.2 13.5 10.5 4.8 0 4.8V0c13.2 0 24 10.8 24 24h-4.8zM3.3 17.4c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3C1.5 24 0 22.5 0 20.7s1.5-3.3 3.3-3.3zM15.9 24h-4.7c0-6.2-5.1-11.2-11.2-11.2V8.1c8.7 0 15.9 7.2 15.9 15.9z"/></svg> Atom Feed</a>
                    </p>
                </div>
        </div>
</div>

                </footer> 

                <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
                <style>    
.rss svg{
  max-width:14px;
  max-height: 14px;
}
</style>

<style>
body{font-size:20px;color:#333333}p{line-height:1.5;margin:30px 0}p a{text-decoration:underline}h1,h2,h3,h4,h5,h6{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:800}a{color:#333333}a:hover,a:focus{color:#337ab7}a img:hover,a img:focus{cursor:zoom-in}blockquote{color:#555555;font-style:italic}blockquote > p{margin-top:0}hr.small{max-width:100px;margin:15px auto;border-width:4px;border-color:white}.navbar-custom{position:absolute;top:0;left:0;width:100%;z-index:3;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif}.navbar-custom .navbar-brand{font-weight:800}.navbar-custom .nav li a{text-transform:uppercase;font-size:12px;font-weight:800;letter-spacing:1px}@media only screen and (min-width:768px){.navbar-custom{background:transparent;border-bottom:1px solid transparent}.navbar-custom .navbar-brand{color:white;padding:20px}.navbar-custom .navbar-brand:hover,.navbar-custom .navbar-brand:focus{color:rgba(255,255,255,0.8)}.navbar-custom .nav li a{color:white;padding:20px}.navbar-custom .nav li a:hover,.navbar-custom .nav li a:focus{color:rgba(255,255,255,0.8)}.navbar-custom .nav .open .dropdown-menu li a{color:#333333}}@media only screen and (min-width:1170px){.navbar-custom{-webkit-transition:background-color 0.3s;-moz-transition:background-color 0.3s;transition:background-color 0.3s;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.navbar-custom.is-fixed{position:fixed;top:-61px;background-color:rgba(255,255,255,0.9);border-bottom:1px solid #f2f2f2;-webkit-transition:-webkit-transform 0.3s;-moz-transition:-moz-transform 0.3s;transition:transform 0.3s}.navbar-custom.is-fixed .navbar-brand{color:#333333}.navbar-custom.is-fixed .navbar-brand:hover,.navbar-custom.is-fixed .navbar-brand:focus{color:#337ab7}.navbar-custom.is-fixed .nav li a{color:#333333}.navbar-custom.is-fixed .nav li a:hover,.navbar-custom.is-fixed .nav li a:focus{color:#337ab7}.navbar-custom.is-visible{-webkit-transform:translate3d(0,100%,0);-moz-transform:translate3d(0,100%,0);-ms-transform:translate3d(0,100%,0);-o-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}}.intro-header{background-color:#555555;background:no-repeat center center;background-attachment:scroll;-webkit-background-size:cover;-moz-background-size:cover;background-size:cover;-o-background-size:cover;margin-bottom:50px}.intro-header .site-heading,.intro-header .post-heading,.intro-header .page-heading{padding:100px 0 50px;color:white}@media only screen and (min-width:768px){.intro-header .site-heading,.intro-header .post-heading,.intro-header .page-heading{padding:150px 0}}.intro-header .site-heading,.intro-header .page-heading{text-align:center}.intro-header .site-heading h1,.intro-header .page-heading h1{margin-top:0;font-size:50px}.intro-header .site-heading .subheading,.intro-header .page-heading .subheading{font-size:24px;line-height:1.1;display:block;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:300;margin:10px 0 0}@media only screen and (min-width:768px){.intro-header .site-heading h1,.intro-header .page-heading h1{font-size:80px}}.intro-header .post-heading h1{font-size:35px}.intro-header .post-heading .subheading,.intro-header .post-heading .meta{line-height:1.1;display:block}.intro-header .post-heading .subheading{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:24px;margin:10px 0 30px;font-weight:600}.intro-header .post-heading .meta{font-weight:300;font-size:20px}.intro-header .post-heading .meta a{color:white}@media only screen and (min-width:768px){.intro-header .post-heading h1{font-size:55px}.intro-header .post-heading .subheading{font-size:30px}}.post-preview > a{color:#333333}.post-preview > a:hover,.post-preview > a:focus{text-decoration:none;color:#337ab7}.post-preview > a > .post-title{font-size:30px;margin-top:30px;margin-bottom:10px}.post-preview > a > .post-subtitle{margin:0;font-weight:300;margin-bottom:10px}.post-preview > .post-meta{color:#777777;font-size:18px;font-style:italic;margin-top:0}.post-preview > .post-meta > a{text-decoration:none;color:#333333}.post-preview > .post-meta > a:hover,.post-preview > .post-meta > a:focus{color:#337ab7;text-decoration:underline}@media only screen and (min-width:768px){.post-preview > a > .post-title{font-size:36px}}.section-heading{font-size:36px;margin-top:60px;font-weight:700}.caption{text-align:center;font-size:14px;padding:10px;font-style:italic;margin:0;display:block;border-bottom-right-radius:5px;border-bottom-left-radius:5px}footer{padding:50px 0 65px}footer .list-inline{margin:0;padding:0}footer .copyright{font-size:14px;text-align:center;margin-bottom:0}.floating-label-form-group{font-size:14px;position:relative;margin-bottom:0;padding-bottom:0.5em;border-bottom:1px solid #777777}.floating-label-form-group input,.floating-label-form-group textarea{z-index:1;position:relative;padding-right:0;padding-left:0;border:none;border-radius:0;font-size:1.5em;background:none;box-shadow:none !important;resize:none}.floating-label-form-group label{display:block;z-index:0;position:relative;top:2em;margin:0;font-size:0.85em;line-height:1.764705882em;vertical-align:middle;vertical-align:baseline;opacity:0;-webkit-transition:top 0.3s ease,opacity 0.3s ease;-moz-transition:top 0.3s ease,opacity 0.3s ease;-ms-transition:top 0.3s ease,opacity 0.3s ease;transition:top 0.3s ease,opacity 0.3s ease}.floating-label-form-group::not(:first-child){padding-left:14px;border-left:1px solid #777777}.floating-label-form-group-with-value label{top:0;opacity:1}.floating-label-form-group-with-focus label{color:#337ab7}form .row:first-child .floating-label-form-group{border-top:1px solid #777777}.btn{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;text-transform:uppercase;font-size:14px;font-weight:800;letter-spacing:1px;border-radius:0;padding:15px 25px}.btn-lg{font-size:16px;padding:25px 35px}.btn-default:hover,.btn-default:focus{background-color:#337ab7;border:1px solid #337ab7;color:white}.pager{margin:20px 0 0}.pager li > a,.pager li > span{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;text-transform:uppercase;font-size:14px;font-weight:800;letter-spacing:1px;padding:15px 25px;background-color:white;border-radius:0}.pager li > a:hover,.pager li > a:focus{color:white;background-color:#337ab7;border:1px solid #337ab7}.pager .disabled > a,.pager .disabled > a:hover,.pager .disabled > a:focus,.pager .disabled > span{color:#555555;background-color:#333333;cursor:not-allowed}::-moz-selection{color:white;text-shadow:none;background:#337ab7}::selection{color:white;text-shadow:none;background:#337ab7}img::selection{color:white;background:transparent}img::-moz-selection{color:white;background:transparent}body{webkit-tap-highlight-color:#337ab7}
</style>
<style>
#intro-header{background-color:#555555;max-height:450px}.intro-header .site-heading .subheading{line-height:1.6}.intro-header .site-heading *,.intro-header .post-heading *{text-shadow:0 0 80px rgba(0,0,0,0.8)}.intro-header.background--light .site-heading *,.intro-header.background--light .post-heading *{text-shadow:0 0 80px rgba(255,255,255,0.8)}.intro-header.background--light *,.navbar:not(.is-fixed).background--light *{color:#000 !important}hr.background--light{border-color:#000 !important}.btn.background--light{color:initial !important}.btn{margin-bottom:6px}.btn-sm{font-size:12px;padding:5px 10px}.btn-xs{font-size:12px;padding:1px 5px}.right-border{border-right:1px solid #eeeeee}.sidebar li{margin-bottom:8px}.post-list > a{color:#333333}.post-list > a:hover,.post-list > a:focus{text-decoration:none;color:#337ab7}.post-list > a > .post-title{margin-top:10px;margin-bottom:6px}.post-list > a > .post-subtitle{margin:0;font-weight:300;margin-bottom:6px}.post-list > .post-meta{color:#777777;font-size:16px;font-style:italic;margin-top:0}.post-list > .post-meta > a{text-decoration:none;color:#333333}.post-list > .post-meta > a:hover,.post-list > .post-meta > a:focus{color:#337ab7;text-decoration:underline}.post-heading .subheading{margin-bottom:0}.post-heading .meta{margin-top:30px}.post-heading .tags{margin-top:30px}.post-heading .tags .btn{border-color:#222222}pre,pre.prettyprint{padding:8px;margin:0;overflow:auto;word-wrap:normal;word-break:normal;border-color:#dddddd;background-color:#eeeeee;margin-bottom:20px}code{background-color:#eeeeee;color:#555555}.panel .table pre{margin:0;border:none;border-top-left-radius:0;border-top-right-radius:0}.col-top{vertical-align:top}.col-middle{vertical-align:middle}.col-bottom{vertical-align:bottom}.container-xs-height{display:table;padding-left:0;padding-right:0}.row-xs-height{display:table-row}.col-xs-height{display:table-cell;float:none}@media (min-width:768px){.container-sm-height{display:table;padding-left:0;padding-right:0}.row-sm-height{display:table-row}.col-sm-height{display:table-cell;float:none}}@media (min-width:992px){.container-md-height{display:table;padding-left:0;padding-right:0}.row-md-height{display:table-row}.col-md-height{display:table-cell;float:none}}@media (min-width:1200px){.container-lg-height{display:table;padding-left:0;padding-right:0}.row-lg-height{display:table-row}.col-lg-height{display:table-cell;float:none}}.btn-default{color:#333;background-color:#fff;border-color:#ccc}
</style>
<style>
.hljs{display:block;overflow-x:auto;padding:0.5em;background:#F0F0F0}.hljs,.hljs-subst{color:#444}.hljs-comment{color:#888888}.hljs-keyword,.hljs-attribute,.hljs-selector-tag,.hljs-meta-keyword,.hljs-doctag,.hljs-name{font-weight:bold}.hljs-type,.hljs-string,.hljs-number,.hljs-selector-id,.hljs-selector-class,.hljs-quote,.hljs-template-tag,.hljs-deletion{color:#880000}.hljs-title,.hljs-section{color:#880000;font-weight:bold}.hljs-regexp,.hljs-symbol,.hljs-variable,.hljs-template-variable,.hljs-link,.hljs-selector-attr,.hljs-selector-pseudo{color:#BC6060}.hljs-literal{color:#78A960}.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-addition{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta-string{color:#4d99bf}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:bold}
</style>

                <script src="/assets/js/highlight.pack.js"></script>   
                <script src="/assets/js/clean-blog.js" defer async></script>
                
                
                <script>
                        hljs.initHighlightingOnLoad();
                </script>
        </body>
</html>

